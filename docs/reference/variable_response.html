<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Marginal Response for a Single Variable — variable_response • DALEX</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top navbar-mi2" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class = "navbar-mi2logo" href="http://mi2.mini.pw.edu.pl/">
        <img src = "https://github.com/mi2-warsaw/MI2template/blob/master/inst/pkgdown/assets/MI2logo.jpg?raw=true" alt = "MI2" height = 46 title = "MI2">
	  </a>
      <a class="navbar-brand navbar-mi2" href="../index.html">DALEX</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-mi2 nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/DALEX_and_xgboost.html">How to use DALEX with the xgboost models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Marginal Response for a Single Variable</h1>
    </div>

    
    <p>Calculates the average model response as a function of a single selected variable.
Use the 'type' parameter to select the type of marginal response to be calculated.
Currently for numeric variables we have Partial Dependency and Accumulated Local Effects implemented.
Current implementation uses the 'pdp' package (Brandon M. Greenwell (2017).
pdp: An R Package for Constructing Partial Dependence Plots. The R Journal, 9(1), 421--436.)
and 'ALEPlot' (Dan Apley (2017). ALEPlot: Accumulated Local Effects Plots and Partial Dependence Plots.)</p>
    

    <pre class="usage"><span class='fu'>variable_response</span>(<span class='no'>explainer</span>, <span class='no'>variable</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"pdp"</span>, <span class='kw'>trans</span> <span class='kw'>=</span> <span class='no'>explainer</span>$<span class='no'>link</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>explainer</th>
      <td><p>a model to be explained, preprocessed by the 'explain' function</p></td>
    </tr>
    <tr>
      <th>variable</th>
      <td><p>character - name of a single variable</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>character - type of the response to be calculated.
Currently following options are implemented: 'pdp' for Partial Dependency and 'ale' for Accumulated Local Effects</p></td>
    </tr>
    <tr>
      <th>trans</th>
      <td><p>function - a transformation/link function that shall be applied to raw model predictions. This will be inherited from the explainer.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of the class 'svariable_response_explainer'.
It's a data frame with calculated average response.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For factor variables we are using the 'factorMerger' package.
Please note that the argument <code>type</code> must be set to <code>'factor'</code> to use this method.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='st'>"breakDown"</span>)
<span class='no'>logit</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>exp</span>(<span class='no'>x</span>)/(<span class='fl'>1</span>+<span class='fu'>exp</span>(<span class='no'>x</span>))

<span class='no'>HR_glm_model</span> <span class='kw'>&lt;-</span> <span class='fu'>glm</span>(<span class='no'>left</span>~<span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw pkg'>breakDown</span><span class='kw ns'>::</span><span class='no'><a href='http://www.rdocumentation.org/packages/breakDown/topics/HR_data'>HR_data</a></span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>)
<span class='no'>explainer_glm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='explain.html'>explain</a></span>(<span class='no'>HR_glm_model</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>HR_data</span>, <span class='kw'>trans</span><span class='kw'>=</span><span class='no'>logit</span>)
<span class='no'>expl_glm</span> <span class='kw'>&lt;-</span> <span class='fu'>variable_response</span>(<span class='no'>explainer_glm</span>, <span class='st'>"satisfaction_level"</span>, <span class='st'>"pdp"</span>)
<span class='no'>expl_glm</span></div><div class='output co'>#&gt;         x            y                var type label
#&gt; 1  0.0900 0.280409.... satisfaction_level  pdp    lm
#&gt; 2  0.1082 0.242774.... satisfaction_level  pdp    lm
#&gt; 3  0.1264 0.205140.... satisfaction_level  pdp    lm
#&gt; 4  0.1446 0.167505.... satisfaction_level  pdp    lm
#&gt; 5  0.1628 0.129870.... satisfaction_level  pdp    lm
#&gt; 6  0.1810 0.092235.... satisfaction_level  pdp    lm
#&gt; 7  0.1992 0.054601.... satisfaction_level  pdp    lm
#&gt; 8  0.2174 0.016966.... satisfaction_level  pdp    lm
#&gt; 9  0.2356 -0.02066.... satisfaction_level  pdp    lm
#&gt; 10 0.2538 -0.05830.... satisfaction_level  pdp    lm
#&gt; 11 0.2720 -0.09593.... satisfaction_level  pdp    lm
#&gt; 12 0.2902 -0.13357.... satisfaction_level  pdp    lm
#&gt; 13 0.3084 -0.17120.... satisfaction_level  pdp    lm
#&gt; 14 0.3266 -0.20884.... satisfaction_level  pdp    lm
#&gt; 15 0.3448 -0.24647.... satisfaction_level  pdp    lm
#&gt; 16 0.3630 -0.28411.... satisfaction_level  pdp    lm
#&gt; 17 0.3812 -0.32174.... satisfaction_level  pdp    lm
#&gt; 18 0.3994 -0.35938.... satisfaction_level  pdp    lm
#&gt; 19 0.4176 -0.39701.... satisfaction_level  pdp    lm
#&gt; 20 0.4358 -0.43465.... satisfaction_level  pdp    lm
#&gt; 21 0.4540 -0.47228.... satisfaction_level  pdp    lm
#&gt; 22 0.4722 -0.50992.... satisfaction_level  pdp    lm
#&gt; 23 0.4904 -0.54755.... satisfaction_level  pdp    lm
#&gt; 24 0.5086 -0.58519.... satisfaction_level  pdp    lm
#&gt; 25 0.5268 -0.62282.... satisfaction_level  pdp    lm
#&gt; 26 0.5450 -0.66045.... satisfaction_level  pdp    lm
#&gt; 27 0.5632 -0.69809.... satisfaction_level  pdp    lm
#&gt; 28 0.5814 -0.73572.... satisfaction_level  pdp    lm
#&gt; 29 0.5996 -0.77336.... satisfaction_level  pdp    lm
#&gt; 30 0.6178 -0.81099.... satisfaction_level  pdp    lm
#&gt; 31 0.6360 -0.84863.... satisfaction_level  pdp    lm
#&gt; 32 0.6542 -0.88626.... satisfaction_level  pdp    lm
#&gt; 33 0.6724 -0.92390.... satisfaction_level  pdp    lm
#&gt; 34 0.6906 -0.96153.... satisfaction_level  pdp    lm
#&gt; 35 0.7088 -0.99917.... satisfaction_level  pdp    lm
#&gt; 36 0.7270 -1.03680.... satisfaction_level  pdp    lm
#&gt; 37 0.7452 -1.07444.... satisfaction_level  pdp    lm
#&gt; 38 0.7634 -1.11207.... satisfaction_level  pdp    lm
#&gt; 39 0.7816 -1.14971.... satisfaction_level  pdp    lm
#&gt; 40 0.7998 -1.18734.... satisfaction_level  pdp    lm
#&gt; 41 0.8180 -1.22498.... satisfaction_level  pdp    lm
#&gt; 42 0.8362 -1.26261.... satisfaction_level  pdp    lm
#&gt; 43 0.8544 -1.30025.... satisfaction_level  pdp    lm
#&gt; 44 0.8726 -1.33788.... satisfaction_level  pdp    lm
#&gt; 45 0.8908 -1.37552.... satisfaction_level  pdp    lm
#&gt; 46 0.9090 -1.41315.... satisfaction_level  pdp    lm
#&gt; 47 0.9272 -1.45078.... satisfaction_level  pdp    lm
#&gt; 48 0.9454 -1.48842.... satisfaction_level  pdp    lm
#&gt; 49 0.9636 -1.52605.... satisfaction_level  pdp    lm
#&gt; 50 0.9818 -1.56369.... satisfaction_level  pdp    lm
#&gt; 51 1.0000 -1.60132.... satisfaction_level  pdp    lm</div><div class='input'>
<span class='co'>#\dontrun{</span>
<span class='fu'>library</span>(<span class='st'>"randomForest"</span>)
<span class='no'>HR_rf_model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/randomForest/topics/randomForest'>randomForest</a></span>(<span class='fu'>factor</span>(<span class='no'>left</span>)~<span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw pkg'>breakDown</span><span class='kw ns'>::</span><span class='no'><a href='http://www.rdocumentation.org/packages/breakDown/topics/HR_data'>HR_data</a></span>, <span class='kw'>ntree</span> <span class='kw'>=</span> <span class='fl'>100</span>)
<span class='no'>explainer_rf</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='explain.html'>explain</a></span>(<span class='no'>HR_rf_model</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>HR_data</span>,
                       <span class='kw'>predict_function</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>model</span>, <span class='no'>x</span>)
                              <span class='fu'>predict</span>(<span class='no'>model</span>, <span class='no'>x</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"prob"</span>)[,<span class='fl'>2</span>])
<span class='no'>expl_rf</span>  <span class='kw'>&lt;-</span> <span class='fu'>variable_response</span>(<span class='no'>explainer_rf</span>, <span class='kw'>variable</span> <span class='kw'>=</span> <span class='st'>"satisfaction_level"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"pdp"</span>,
                       <span class='kw'>which.class</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>expl_rf</span></div><div class='output co'>#&gt;         x            y                var type        label
#&gt; 1  0.0900 0.749461.... satisfaction_level  pdp randomForest
#&gt; 2  0.1082 0.731087.... satisfaction_level  pdp randomForest
#&gt; 3  0.1264 0.132573.... satisfaction_level  pdp randomForest
#&gt; 4  0.1446 0.137143.... satisfaction_level  pdp randomForest
#&gt; 5  0.1628 0.089313.... satisfaction_level  pdp randomForest
#&gt; 6  0.1810 0.081468.... satisfaction_level  pdp randomForest
#&gt; 7  0.1992 0.075886.... satisfaction_level  pdp randomForest
#&gt; 8  0.2174 0.076050.... satisfaction_level  pdp randomForest
#&gt; 9  0.2356 0.075510.... satisfaction_level  pdp randomForest
#&gt; 10 0.2538 0.080541.... satisfaction_level  pdp randomForest
#&gt; 11 0.2720 0.081543.... satisfaction_level  pdp randomForest
#&gt; 12 0.2902 0.088502.... satisfaction_level  pdp randomForest
#&gt; 13 0.3084 0.146231.... satisfaction_level  pdp randomForest
#&gt; 14 0.3266 0.126425.... satisfaction_level  pdp randomForest
#&gt; 15 0.3448 0.139771.... satisfaction_level  pdp randomForest
#&gt; 16 0.3630 0.189618.... satisfaction_level  pdp randomForest
#&gt; 17 0.3812 0.180210.... satisfaction_level  pdp randomForest
#&gt; 18 0.3994 0.177327.... satisfaction_level  pdp randomForest
#&gt; 19 0.4176 0.187878.... satisfaction_level  pdp randomForest
#&gt; 20 0.4358 0.185192.... satisfaction_level  pdp randomForest
#&gt; 21 0.4540 0.186061.... satisfaction_level  pdp randomForest
#&gt; 22 0.4722 0.093260.... satisfaction_level  pdp randomForest
#&gt; 23 0.4904 0.056608.... satisfaction_level  pdp randomForest
#&gt; 24 0.5086 0.053845.... satisfaction_level  pdp randomForest
#&gt; 25 0.5268 0.052090.... satisfaction_level  pdp randomForest
#&gt; 26 0.5450 0.053234.... satisfaction_level  pdp randomForest
#&gt; 27 0.5632 0.050258.... satisfaction_level  pdp randomForest
#&gt; 28 0.5814 0.049664.... satisfaction_level  pdp randomForest
#&gt; 29 0.5996 0.048391.... satisfaction_level  pdp randomForest
#&gt; 30 0.6178 0.050323.... satisfaction_level  pdp randomForest
#&gt; 31 0.6360 0.050634.... satisfaction_level  pdp randomForest
#&gt; 32 0.6542 0.052825.... satisfaction_level  pdp randomForest
#&gt; 33 0.6724 0.053850.... satisfaction_level  pdp randomForest
#&gt; 34 0.6906 0.056275.... satisfaction_level  pdp randomForest
#&gt; 35 0.7088 0.070244.... satisfaction_level  pdp randomForest
#&gt; 36 0.7270 0.098007.... satisfaction_level  pdp randomForest
#&gt; 37 0.7452 0.096470.... satisfaction_level  pdp randomForest
#&gt; 38 0.7634 0.096977.... satisfaction_level  pdp randomForest
#&gt; 39 0.7816 0.101724.... satisfaction_level  pdp randomForest
#&gt; 40 0.7998 0.101082.... satisfaction_level  pdp randomForest
#&gt; 41 0.8180 0.097376.... satisfaction_level  pdp randomForest
#&gt; 42 0.8362 0.096482.... satisfaction_level  pdp randomForest
#&gt; 43 0.8544 0.100287.... satisfaction_level  pdp randomForest
#&gt; 44 0.8726 0.095666.... satisfaction_level  pdp randomForest
#&gt; 45 0.8908 0.099734.... satisfaction_level  pdp randomForest
#&gt; 46 0.9090 0.092613.... satisfaction_level  pdp randomForest
#&gt; 47 0.9272 0.058687.... satisfaction_level  pdp randomForest
#&gt; 48 0.9454 0.052801.... satisfaction_level  pdp randomForest
#&gt; 49 0.9636 0.051148.... satisfaction_level  pdp randomForest
#&gt; 50 0.9818 0.051148.... satisfaction_level  pdp randomForest
#&gt; 51 1.0000 0.051148.... satisfaction_level  pdp randomForest</div><div class='input'>#}

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
